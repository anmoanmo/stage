# 阶段 0｜打底与工具链 — 学习资料清单（精选）

下面按“工具→文档→视频/实践”给你一套够用不贵的入口。每一项都经挑选，尽量以官方文档为主，中文资料和 bilibili 作为补充。

## 1) 编译与构建（GCC/Clang、CMake、Makefile）

* **CMake 官方入门 & 教程**：安装、Presets、CTest 全在这。适合直接照着做项目模板。 ([valgrind.org](https://valgrind.org/docs/manual/mc-manual.html?utm_source=chatgpt.com "4. Memcheck: a memory error detector"))
* **Modern CMake 指南**（Henry Schreiner，社区公认的现代写法讲解，含目标导向/接口库等）：适合把老式 `add_definitions` 思维换掉。 ([man7.org](https://man7.org/linux/man-pages/man1/strace.1.html?utm_source=chatgpt.com "strace(1) - Linux manual page"))
* **Makefile 中文权威教程（陈皓《跟我一起写Makefile》重制版/在线版）**：构建规则、隐式规则写得非常系统。 ([SeisMan的项目列表](https://seisman.github.io/how-to-write-makefile/overview.html "概述 — 跟我一起写Makefile 1.0 文档"), [GitHub](https://github.com/seisman/how-to-write-makefile "GitHub - seisman/how-to-write-makefile: 跟我一起写Makefile重制版"))
* **b站：现代 CMake 系列视频（入门到实战）**：可配合官方文档反复对照。 ([哔哩哔哩](https://www.bilibili.com/video/BV1A7411f7jT/?utm_source=chatgpt.com "CMake简明教程以及现代CMake"), [哔哩哔哩](https://m.bilibili.com/search?keyword=cmake&utm_source=chatgpt.com "cmake-哔哩哔哩_Bilibili"))

## 2) 版本控制（Git）

* **Pro Git（官方电子书，含中文）**：系统讲解分支、变基、工作流。 ([google.github.io](https://google.github.io/benchmark/user_guide.html?utm_source=chatgpt.com "User Guide | benchmark - Google - GitHub Pages"))
* **Git 官方参考手册**：查命令语义用。 ([GitHub](https://github.com/martinus/robin-hood-hashing?utm_source=chatgpt.com "martinus/robin-hood-hashing: Fast & memory efficient ..."))

## 3) 调试与诊断（gdb / strace / perf）

* **gdb 官方手册（网页版 & PDF）**：断点、BT、TUI、反向调试等全覆盖。建议收藏 PDF 搜索。 ([sourceware.org](https://sourceware.org/gdb/current/onlinedocs/gdb?utm_source=chatgpt.com "Debugging with GDB"))
* **strace 官方仓库 README**（用法与定位系统调用层问题的定位思路）。 ([GitHub](https://github.com/strace/strace/blob/master/README.md?utm_source=chatgpt.com "strace/README.md at master"))
* **perf 官方/社区教程**：
  * Brendan Gregg 的 perf/火焰图资料与工具集（入门看法门、进阶看细节）。 ([GitHub](https://github.com/marketplace/actions/ctest-action?utm_source=chatgpt.com "CTest Action - GitHub Marketplace"), [Manning Publications](https://www.manning.com/books/c-plus-plus-concurrency-in-action-second-edition?utm_source=chatgpt.com "C++ Concurrency in Action, Second Edition"))
  * 内核 `perf_event_paranoid` 权限说明与修改方法（CI/容器/云主机上常被卡住）。 ([Linux内核文档](https://docs.kernel.org/admin-guide/sysctl/kernel.html?utm_source=chatgpt.com "Documentation for /proc/sys/kernel"), [Linux Audit](https://linux-audit.com/kernel/sysctl/kernel/kernel.perf_event_paranoid/?utm_source=chatgpt.com "Sysctl: kernel.perf_event_paranoid - Linux Audit"), [Ask Ubuntu](https://askubuntu.com/questions/1471162/how-to-change-kernel-perf-event-paranoid-settings?utm_source=chatgpt.com "How to change kernel.perf_event_paranoid settings?"))
* **b站：perf + 火焰图、原理与实战文章/视频**（中文讲解，适合先感性认识再回到官方文档）。 ([哔哩哔哩](https://www.bilibili.com/video/BV1hg4y1o7Sb/?utm_source=chatgpt.com "【火焰图🔥】Linux C/C++性能优化分析工具Perf使用教程"))

## 4) 运行时问题定位（ASan / UBSan / Valgrind）

* **AddressSanitizer（ASan）官方文档（Clang）**：最快上手的内存错误探测器，开发期必开。 ([clang.llvm.org](https://clang.llvm.org/docs/AddressSanitizer.html?utm_source=chatgpt.com "AddressSanitizer — Clang 22.0.0git documentation"))
* **UBSan（UndefinedBehaviorSanitizer）官方文档（Clang）**：整数溢出、越界、空指针解引用等 UB 检测。 ([clang.llvm.org](https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html?utm_source=chatgpt.com "UndefinedBehaviorSanitizer — Clang 22.0.0git documentation"))
* **Google Sanitizers 总览**：ASan/LSan/TSan/MSan 的统一入口。 ([GitHub](https://github.com/google/sanitizers?utm_source=chatgpt.com "google/sanitizers: AddressSanitizer, ThreadSanitizer, ..."))
* **Valgrind 官方手册（Memcheck/Helgrind 等）**：慢但全面，联调复杂问题时兜底。 ([valgrind.org](https://valgrind.org/docs/manual/manual.html?utm_source=chatgpt.com "Valgrind User Manual"))
* **b站：ASAN 与 Valgrind 对比讲解**（中文视频，理解各自适用场景）。 ([哔哩哔哩](https://www.bilibili.com/video/BV1wh4y1B7MM/?utm_source=chatgpt.com "C/C++内存泄漏检测工具ASAN和Valgrind"))

## 5) C++ 并发基石（`std::thread/mutex/condvar/atomic`）

* **cppreference（权威速查）**：
  * `std::thread`、`std::mutex`、`std::condition_variable`、`std::atomic`。建议配合示例与“内存序”章节反复看。 ([LLVM Apt](https://apt.llvm.org/?utm_source=chatgpt.com "LLVM Debian/Ubuntu packages"), [Reddit](https://www.reddit.com/r/linux4noobs/comments/17ooche/what_is_buildessential_and_why_i_need_it_to/?utm_source=chatgpt.com "What is build-essential and why I need it to program in C++?"), [Ask Ubuntu](https://askubuntu.com/questions/309786/llvm-and-clang-installation-on-ubuntu?utm_source=chatgpt.com "llvm and clang installation on ubuntu"))
* **权威教材**：*C++ Concurrency in Action (2nd)*（Anthony Williams）——工程实践与标准语义讲得非常细。 ([Cppreference](https://en.cppreference.com/w/cpp/thread/thread.html?utm_source=chatgpt.com "std::thread"))
* **b站：用条件变量实现线程安全队列（系列视频）**：结合代码把 API 串起来。 ([哔哩哔哩](https://www.bilibili.com/video/BV1934y1N7Nb?utm_source=chatgpt.com "C++ 并发编程(6) 利用条件变量实现线程安全队列"))

## 6) 单元测试与基准（GoogleTest / Google Benchmark）

* **GoogleTest 官方 Quickstart（CMake）**：一步步拉起 gtest 并用 CTest 发现测试。 ([google.github.io](https://google.github.io/googletest/quickstart-cmake.html?utm_source=chatgpt.com "Quickstart: Building with CMake | GoogleTest"))
* **Google Benchmark 官方仓库（User Guide/示例）**：压测微基准、参数化、统计学配置等。 ([GitHub](https://github.com/google/benchmark?utm_source=chatgpt.com "google/benchmark: A microbenchmark support library"), [Chromium Git Repositories](https://chromium.googlesource.com/external/github.com/google/benchmark/%2Bshow/4b0533b726dd8613f7d5fd0d1d044ce81f05651d/README.md?utm_source=chatgpt.com "README.md - external/github.com/google/benchmark - ..."))

## 7) 参考实现/现代 C++ 风格体会

* **robin-hood-hashing**（现代 C++ 风格的无序容器替代，学习接口/性能 & 阅读优雅实现）。 ([GitHub](https://github.com/martinus/robin-hood-hashing?utm_source=chatgpt.com "martinus/robin-hood-hashing: Fast & memory efficient ..."))

---

## 建议学习顺序（配你“必做”产出）

1. **把工具链装对并验证**：`gcc/clang`、CMake、`gdb`、`valgrind`、`perf`。CMake 自带 `CTest`，顺便装上。若 `perf` 报权限，临时用：`sudo sysctl kernel.perf_event_paranoid=1`（或写入 `/etc/sysctl.d/*.conf` 永久生效）。 ([Ask Ubuntu](https://askubuntu.com/questions/1471162/how-to-change-kernel-perf-event-paranoid-settings?utm_source=chatgpt.com "How to change kernel.perf_event_paranoid settings?"))
2. **先用 GoogleTest 起一个最小工程**（如下 CI 模板），跑通 CTest；再加 Google Benchmark，测你后面要写的“线程安全队列/定时器”。 ([google.github.io](https://google.github.io/googletest/quickstart-cmake.html?utm_source=chatgpt.com "Quickstart: Building with CMake | GoogleTest"), [GitHub](https://github.com/google/benchmark?utm_source=chatgpt.com "google/benchmark: A microbenchmark support library"))
3. **并发 API 逐个练**：按 cppreference 顺序做小实验（不同 `memory_order`、虚假唤醒与 `while` 循环等）。 ([Ask Ubuntu](https://askubuntu.com/questions/309786/llvm-and-clang-installation-on-ubuntu?utm_source=chatgpt.com "llvm and clang installation on ubuntu"))
4. **调试与诊断**：
   * 触发一次越界/Use-after-free，用 **ASan** 定位。 ([clang.llvm.org](https://clang.llvm.org/docs/AddressSanitizer.html?utm_source=chatgpt.com "AddressSanitizer — Clang 22.0.0git documentation"))
   * 用 **Valgrind/Memcheck** 复核一次泄漏报告。 ([valgrind.org](https://valgrind.org/docs/manual/mc-manual.html?utm_source=chatgpt.com "4. Memcheck: a memory error detector"))
   * 用 **strace** 看系统调用序列；用 **perf** 采样 + 生成火焰图，定位热点。 ([GitHub](https://github.com/strace/strace/blob/master/README.md?utm_source=chatgpt.com "strace/README.md at master"))

---

## GitHub Actions（单测+基准）最小工作流示例

把下面文件保存为 `.github/workflows/ci.yml`，能在云端一键编译、跑测与基准（基准设短一点避免时长超限）。

```yaml
name: ci
on:
  push: { branches: ["**"] }
  pull_request:
jobs:
  linux:
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4
      - name: Setup C++ toolchain
        uses: aminya/setup-cpp@v1
        with:
          compiler: llvm
          cmake: true
          ninja: true
      - name: Configure
        run: cmake -S . -B build -G Ninja -DCMAKE_BUILD_TYPE=RelWithDebInfo -DBUILD_TESTING=ON
      - name: Build
        run: cmake --build build -j
      - name: Run tests (CTest)
        run: ctest --test-dir build --output-on-failure
      - name: Run microbench (short)
        run: |
          if [ -f build/bench/microbench ]; then
            build/bench/microbench --benchmark_min_time=0.05 --benchmark_repetitions=3
          fi
```

工作流里 `setup-cpp` 与 CMake Action 都是社区常用做法；如需更“官方模板”，可直接参考 GitHub 的 CMake starter workflows。 ([GitHub](https://github.com/marketplace/actions/setup-cpp-c-c?utm_source=chatgpt.com "Setup Cpp (C++ / C) · Actions"))

---

## 小贴士（容易踩的点）

* **perf 权限**：非 root 环境下常被 `perf_event_paranoid` 卡住；临时生效用 `sudo sysctl kernel.perf_event_paranoid=1`，永久写 `/etc/sysctl.d/*.conf`。云 Runner 有时设为 3 或 4，需要降级。 ([Ask Ubuntu](https://askubuntu.com/questions/1471162/how-to-change-kernel-perf-event-paranoid-settings?utm_source=chatgpt.com "How to change kernel.perf_event_paranoid settings?"))
* **ASan/UBSan 与 O2/O3**：可与优化共存，推荐 `-O1/-O2 -g -fsanitize=address,undefined` 开发期常开；上 CI 亦可。依据 Clang 官方文档启用/禁用特定检查项。 ([clang.llvm.org](https://clang.llvm.org/docs/AddressSanitizer.html?utm_source=chatgpt.com "AddressSanitizer — Clang 22.0.0git documentation"))
* **Valgrind 与 Sanitizers 互补**：ASan 更快、适合开发循环；Valgrind 更全、但慢。二者结合定位棘手问题。官方手册有 Memcheck 详解与快速上手。 ([valgrind.org](https://valgrind.org/docs/manual/mc-manual.html?utm_source=chatgpt.com "4. Memcheck: a memory error detector"))

---

如果你希望，我可以基于这些资料给你拉一个**最小工程骨架**（`src/`、`tests/`、`bench/`、`cmake/`、`CI` 全配）并填上：

* `ThreadSafeQueue<T>`（`mutex + condition_variable`，明确虚假唤醒与 `while` 判等）；
* **小顶堆定时器**（`std::chrono::steady_clock` + `priority_queue` + 唤醒策略）；
* GTest & Benchmark 示例 + 运行脚本。

说一声你的目录偏好，我就按你的口味生成。
